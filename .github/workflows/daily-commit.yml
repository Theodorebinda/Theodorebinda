name: Fun Daily Commit ðŸš€

on:
  schedule:
    - cron: '0 0 * * *'
  workflow_dispatch:

jobs:
  daily_fun:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout du dÃ©pÃ´t
        uses: actions/checkout@v4
        with:
          persist-credentials: true
          fetch-depth: 0
      

      - name: Configurer Git
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"

      - name: Tirer les derniÃ¨res modifications
        run: git pull origin main --rebase

      - name: Installer les dÃ©pendances
        run: sudo apt-get install -y jq

      - name: GÃ©nÃ©rer une citation avec un emoji fun et un compteur
        run: |
         
          if [ -f "activity.log" ]; then
            count=$(tail -n 1 activity.log | grep -oE 'Jour [0-9]+' | grep -oE '[0-9]+')
            count=$((count + 1))
          else
            count=1
          fi

         
          emojis=("ðŸš€" "ðŸ”¥" "ðŸŒž" "ðŸŽ‰" "âœ¨" "ðŸŒˆ" "ðŸ’¡" "ðŸ§ " "ðŸŒ" "ðŸ’»" "â˜•" "ðŸ“š" "ðŸŒ±")
          emoji=${emojis[$((RANDOM % ${#emojis[@]}))]}

          # RÃ©cupÃ©rer une citation depuis l'API
          quote=$(curl -s https://api.quotable.io/random | jq -r '.content + " â€” " + .author')

          # Ã‰crire dans le fichier
          echo "Jour $count $emoji - $(date)" > activity.log
          echo "" >> activity.log
          echo "ðŸ’¬ \"$quote\"" >> activity.log

      - name: Commit & Push
        run: |
          git add activity.log
          git commit -m "âœ¨ Jour $count - Commit quotidien avec inspiration et style!" || echo "Rien Ã  committer"
          git push origin main
