name: Fun Daily Commit ðŸš€

on:
  schedule:
    - cron: '0 0 * * *' # Tous les jours Ã  minuit UTC
  workflow_dispatch:

jobs:
  daily_fun:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ›Žï¸ Checkout du dÃ©pÃ´t
        uses: actions/checkout@v4
        with:
          persist-credentials: true
          fetch-depth: 0

      - name: ðŸ“¦ Installer jq
        run: sudo apt-get update && sudo apt-get install -y jq

      - name: âš™ï¸ Configurer Git
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"

      - name: ðŸ”„ Tirer les derniÃ¨res modifications
        run: git pull origin main --rebase

      - name: âœï¸ GÃ©nÃ©rer une citation avec emoji et compteur
        run: |
          # DÃ©terminer le compteur
          if [ -f "activity.log" ]; then
            last_count=$(grep -oE 'Jour [0-9]+' activity.log | tail -n 1 | grep -oE '[0-9]+' || echo 0)
            count=$((last_count + 1))
          else
            count=1
          fi

          # Liste d'emojis
          emojis=("ðŸš€" "ðŸ”¥" "ðŸŒž" "ðŸŽ‰" "âœ¨" "ðŸŒˆ" "ðŸ’¡" "ðŸ§ " "ðŸŒ" "ðŸ’»" "â˜•" "ðŸ“š" "ðŸŒ±")
          emoji=${emojis[$((RANDOM % ${#emojis[@]}))]}

          # RÃ©cupÃ©rer une citation depuis l'API (si Ã©chec â†’ valeur par dÃ©faut)
          quote=$(curl -s https://api.quotable.io/random | jq -r '.content + " â€” " + .author' || echo "Reste motivÃ© et continue d'apprendre â€” Inconnu")

          # Ajouter au fichier (append)
          {
            echo "Jour $count $emoji - $(date)"
            echo ""
            echo "ðŸ’¬ \"$quote\""
            echo ""
          } >> activity.log

      - name: ðŸ’¾ Commit & Push
        run: |
          git add activity.log
          git commit -m "âœ¨ Jour $count - Inspiration quotidienne" || echo "Rien Ã  committer"
          git push origin main
